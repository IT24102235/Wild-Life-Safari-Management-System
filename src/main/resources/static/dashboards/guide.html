<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Guide Dashboard - Ranweli Safari</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="../css/main.css">
    <style>
        .dashboard {
            display: flex;
            min-height: 100vh;
            background: #f8f9fa;
        }

        .sidebar {
            width: 280px;
            background: white;
            box-shadow: 2px 0 10px rgba(0,0,0,0.1);
            position: fixed;
            height: 100vh;
            overflow-y: auto;
            z-index: 1000;
        }

        .sidebar-header {
            padding: 2rem;
            border-bottom: 1px solid #eee;
            text-align: center;
            background: linear-gradient(135deg, #2c5530 0%, #7fb069 100%);
            color: white;
        }

        .guide-badge {
            background: #28a745;
            color: white;
            padding: 0.25rem 0.75rem;
            border-radius: 15px;
            font-size: 0.8rem;
            font-weight: 600;
            margin-top: 0.5rem;
            display: inline-block;
        }

        .performance-card {
            background: rgba(255,255,255,0.1);
            border-radius: 10px;
            padding: 1rem;
            margin-top: 1rem;
            text-align: center;
        }

        .performance-number {
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 0.25rem;
        }

        .performance-label {
            font-size: 0.8rem;
            opacity: 0.9;
        }

        .sidebar-menu {
            padding: 1rem 0;
        }

        .menu-item {
            display: flex;
            align-items: center;
            padding: 1rem 2rem;
            color: var(--text-color);
            text-decoration: none;
            transition: all 0.3s ease;
            border-left: 3px solid transparent;
        }

        .menu-item:hover,
        .menu-item.active {
            background: #f8f9fa;
            border-left-color: var(--primary-color);
            color: var(--primary-color);
        }

        .menu-icon {
            margin-right: 1rem;
            font-size: 1.2rem;
        }

        .main-content {
            flex: 1;
            margin-left: 280px;
            padding: 2rem;
        }

        .guide-header {
            background: white;
            border-radius: 15px;
            padding: 2rem;
            margin-bottom: 2rem;
            box-shadow: var(--shadow);
        }

        .welcome-text h1 {
            color: var(--primary-color);
            margin-bottom: 0.5rem;
        }

        .dashboard-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 2rem;
            margin-bottom: 2rem;
        }

        .stat-card {
            background: white;
            border-radius: 15px;
            padding: 2rem;
            box-shadow: var(--shadow);
            text-align: center;
            transition: transform 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: var(--gradient-primary);
        }

        .stat-card:hover {
            transform: translateY(-5px);
        }

        .stat-icon {
            font-size: 3rem;
            margin-bottom: 1rem;
        }

        .stat-number {
            font-size: 2.5rem;
            font-weight: 700;
            color: var(--primary-color);
            margin-bottom: 0.5rem;
        }

        .stat-label {
            color: var(--text-light);
            font-weight: 500;
        }

        .content-section {
            display: none;
        }

        .content-section.active {
            display: block;
        }

        .assignment-card {
            background: white;
            border-radius: 15px;
            padding: 2rem;
            margin-bottom: 1.5rem;
            box-shadow: var(--shadow);
            transition: transform 0.3s ease;
            border-left: 5px solid var(--primary-color);
        }

        .assignment-card:hover {
            transform: translateY(-3px);
        }

        .assignment-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 1rem;
        }

        .assignment-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin: 1rem 0;
        }

        .detail-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .detail-icon {
            color: var(--primary-color);
        }

        .assignment-actions {
            display: flex;
            gap: 1rem;
            margin-top: 1.5rem;
        }

        .feedback-summary {
            background: white;
            border-radius: 15px;
            padding: 2rem;
            box-shadow: var(--shadow);
            margin-bottom: 2rem;
        }

        .feedback-item {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 1.5rem;
            margin-bottom: 1rem;
            border-left: 4px solid var(--secondary-color);
        }

        .feedback-rating {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin: 1rem 0;
        }

        .rating-display {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .rating-stars {
            display: flex;
            gap: 0.2rem;
        }

        .rating-star {
            color: #ffd700;
            font-size: 1.2rem;
        }

        .profile-form {
            background: white;
            border-radius: 15px;
            padding: 2rem;
            box-shadow: var(--shadow);
        }

        .form-section {
            margin-bottom: 2rem;
        }

        .form-section h3 {
            color: var(--primary-color);
            margin-bottom: 1rem;
            border-bottom: 2px solid #eee;
            padding-bottom: 0.5rem;
        }

        .expertise-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            margin: 1rem 0;
        }

        .expertise-tag {
            background: var(--secondary-color);
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .expertise-tag:hover {
            background: var(--primary-color);
        }

        .availability-calendar {
            background: white;
            border-radius: 15px;
            padding: 2rem;
            box-shadow: var(--shadow);
        }

        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 1rem;
            margin-top: 1rem;
        }

        .calendar-day {
            aspect-ratio: 1;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
        }

        .calendar-day.available {
            background: #e8f5e9;
            border-color: #28a745;
        }

        .calendar-day.booked {
            background: #fff3cd;
            border-color: #ffc107;
        }

        .calendar-day.unavailable {
            background: #f8d7da;
            border-color: #dc3545;
        }

        .status-indicator {
            position: absolute;
            bottom: 2px;
            right: 2px;
            width: 8px;
            height: 8px;
            border-radius: 50%;
        }

        .status-indicator.available { background: #28a745; }
        .status-indicator.booked { background: #ffc107; }
        .status-indicator.unavailable { background: #dc3545; }

        @media (max-width: 768px) {
            .sidebar {
                transform: translateX(-100%);
                transition: transform 0.3s ease;
            }

            .sidebar.active {
                transform: translateX(0);
            }

            .main-content {
                margin-left: 0;
                padding: 1rem;
            }

            .dashboard-stats {
                grid-template-columns: 1fr;
            }

            .assignment-details {
                grid-template-columns: 1fr;
            }

            .assignment-actions {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div class="dashboard">
        <!-- Mobile Menu Toggle -->
        <button class="mobile-menu-toggle" onclick="toggleSidebar()" style="display: none; position: fixed; top: 1rem; left: 1rem; z-index: 1001; background: var(--primary-color); color: white; border: none; padding: 0.75rem; border-radius: 8px; cursor: pointer;">‚ò∞</button>

        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <h3 id="guideName">Kumara Perera</h3>
                <div class="guide-badge">TOUR GUIDE</div>
                <div class="performance-card">
                    <div class="performance-number" id="guideRating">4.8</div>
                    <div class="performance-label">Average Rating</div>
                </div>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-top: 1rem;">
                    <div style="text-align: center;">
                        <div class="performance-number" id="totalSafaris">156</div>
                        <div class="performance-label">Total Safaris</div>
                    </div>
                    <div style="text-align: center;">
                        <div class="performance-number" id="monthlyRating">4.9</div>
                        <div class="performance-label">This Month</div>
                    </div>
                </div>
            </div>

            <nav class="sidebar-menu">
                <a href="#" class="menu-item active" data-section="overview">
                    <span class="menu-icon">üìä</span>
                    Overview
                </a>
                <a href="#" class="menu-item" data-section="assignments">
                    <span class="menu-icon">üìÖ</span>
                    My Assignments
                </a>
                <a href="#" class="menu-item" data-section="schedule">
                    <span class="menu-icon">üóìÔ∏è</span>
                    Schedule
                </a>
                <a href="#" class="menu-item" data-section="feedback">
                    <span class="menu-icon">‚≠ê</span>
                    My Feedback
                </a>
                <a href="#" class="menu-item" data-section="profile">
                    <span class="menu-icon">üë§</span>
                    Profile
                </a>
                <a href="#" class="menu-item" data-section="availability">
                    <span class="menu-icon">üìã</span>
                    Availability
                </a>
            </nav>

            <div style="padding: 2rem;">
                <button class="logout-btn" style="background: #dc3545; color: white; border: none; padding: 0.75rem 1.5rem; border-radius: 8px; cursor: pointer; width: 100%;" onclick="logout()">
                    üö™ Logout
                </button>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Overview Section -->
            <section class="content-section active" id="overview">
                <div class="guide-header">
                    <div class="welcome-text">
                        <h1>Welcome back, <span id="welcomeName">Kumara</span>!</h1>
                        <p>Ready to guide today's safari adventures? Here's your overview.</p>
                    </div>
                </div>

                <div class="dashboard-stats">
                    <div class="stat-card">
                        <div class="stat-icon">üìÖ</div>
                        <div class="stat-number" id="todaysAssignments">2</div>
                        <div class="stat-label">Today's Safaris</div>
                    </div>

                    <div class="stat-card">
                        <div class="stat-icon">üìä</div>
                        <div class="stat-number" id="weeklyAssignments">8</div>
                        <div class="stat-label">This Week</div>
                    </div>

                    <div class="stat-card">
                        <div class="stat-icon">‚≠ê</div>
                        <div class="stat-number" id="recentRating">4.9</div>
                        <div class="stat-label">Recent Rating</div>
                    </div>

                    <div class="stat-card">
                        <div class="stat-icon">üèÜ</div>
                        <div class="stat-number" id="completionRate">98%</div>
                        <div class="stat-label">Completion Rate</div>
                    </div>
                </div>

                <div class="section-header">
                    <h2 class="section-title">Today's Assignments</h2>
                </div>

                <div id="todaysAssignmentsList">
                    <!-- Today's assignments will be loaded here -->
                </div>
            </section>

            <!-- Assignments Section -->
            <section class="content-section" id="assignments">
                <div class="section-header">
                    <h2 class="section-title">My Safari Assignments</h2>
                    <div class="filter-buttons">
                        <button class="filter-btn active" data-filter="all">All</button>
                        <button class="filter-btn" data-filter="upcoming">Upcoming</button>
                        <button class="filter-btn" data-filter="completed">Completed</button>
                        <button class="filter-btn" data-filter="cancelled">Cancelled</button>
                    </div>
                </div>

                <div id="allAssignments">
                    <!-- All assignments will be loaded here -->
                </div>
            </section>

            <!-- Schedule Section -->
            <section class="content-section" id="schedule">
                <div class="section-header">
                    <h2 class="section-title">My Schedule</h2>
                    <div>
                        <button class="btn btn-outline" onclick="exportSchedule()">Export Schedule</button>
                        <button class="btn btn-primary" onclick="requestTimeOff()">Request Time Off</button>
                    </div>
                </div>

                <div class="availability-calendar">
                    <h3 style="color: var(--primary-color); margin-bottom: 1rem;">January 2025</h3>
                    <div style="display: grid; grid-template-columns: repeat(7, 1fr); gap: 1rem; margin-bottom: 1rem; text-align: center; font-weight: 600;">
                        <div>Sun</div><div>Mon</div><div>Tue</div><div>Wed</div><div>Thu</div><div>Fri</div><div>Sat</div>
                    </div>
                    <div class="calendar-grid" id="scheduleCalendar">
                        <!-- Calendar days will be generated here -->
                    </div>

                    <div style="display: flex; gap: 2rem; margin-top: 2rem; justify-content: center;">
                        <div style="display: flex; align-items: center; gap: 0.5rem;">
                            <div class="status-indicator available"></div>
                            <span>Available</span>
                        </div>
                        <div style="display: flex; align-items: center; gap: 0.5rem;">
                            <div class="status-indicator booked"></div>
                            <span>Assigned Safari</span>
                        </div>
                        <div style="display: flex; align-items: center; gap: 0.5rem;">
                            <div class="status-indicator unavailable"></div>
                            <span>Unavailable</span>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Feedback Section -->
            <section class="content-section" id="feedback">
                <div class="section-header">
                    <h2 class="section-title">Customer Feedback</h2>
                </div>

                <div class="feedback-summary">
                    <h3 style="color: var(--primary-color); margin-bottom: 1.5rem;">Performance Summary</h3>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 2rem; margin-bottom: 2rem;">
                        <div style="text-align: center;">
                            <div style="font-size: 2rem; color: var(--primary-color); font-weight: 700;">4.8</div>
                            <div>Overall Rating</div>
                        </div>
                        <div style="text-align: center;">
                            <div style="font-size: 2rem; color: var(--primary-color); font-weight: 700;">156</div>
                            <div>Total Reviews</div>
                        </div>
                        <div style="text-align: center;">
                            <div style="font-size: 2rem; color: var(--primary-color); font-weight: 700;">94%</div>
                            <div>5-Star Reviews</div>
                        </div>
                        <div style="text-align: center;">
                            <div style="font-size: 2rem; color: var(--primary-color); font-weight: 700;">23</div>
                            <div>This Month</div>
                        </div>
                    </div>
                </div>

                <div id="guideFeedbackList">
                    <!-- Feedback items will be loaded here -->
                </div>
            </section>

            <!-- Profile Section -->
            <section class="content-section" id="profile">
                <div class="section-header">
                    <h2 class="section-title">Guide Profile</h2>
                </div>

                <div class="profile-form">
                    <form id="guideProfileForm">
                        <div class="form-section">
                            <h3>Personal Information</h3>
                            <div class="form-row">
                                <div class="form-group">
                                    <label class="form-label">First Name</label>
                                    <input type="text" class="form-control" id="profileFirstName" required>
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Last Name</label>
                                    <input type="text" class="form-control" id="profileLastName" required>
                                </div>
                            </div>

                            <div class="form-row">
                                <div class="form-group">
                                    <label class="form-label">Email</label>
                                    <input type="email" class="form-control" id="profileEmail" required>
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Phone</label>
                                    <input type="tel" class="form-control" id="profilePhone" required>
                                </div>
                            </div>
                        </div>

                        <div class="form-section">
                            <h3>Professional Information</h3>
                            <div class="form-row">
                                <div class="form-group">
                                    <label class="form-label">Years of Experience</label>
                                    <input type="number" class="form-control" id="experience" min="1" max="50">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">License Number</label>
                                    <input type="text" class="form-control" id="licenseNumber">
                                </div>
                            </div>

                            <div class="form-group">
                                <label class="form-label">Languages Spoken</label>
                                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 1rem; margin-top: 0.5rem;">
                                    <div style="display: flex; align-items: center; gap: 0.5rem;">
                                        <input type="checkbox" id="sinhala" checked>
                                        <label for="sinhala">Sinhala</label>
                                    </div>
                                    <div style="display: flex; align-items: center; gap: 0.5rem;">
                                        <input type="checkbox" id="english" checked>
                                        <label for="english">English</label>
                                    </div>
                                    <div style="display: flex; align-items: center; gap: 0.5rem;">
                                        <input type="checkbox" id="tamil">
                                        <label for="tamil">Tamil</label>
                                    </div>
                                    <div style="display: flex; align-items: center; gap: 0.5rem;">
                                        <input type="checkbox" id="german">
                                        <label for="german">German</label>
                                    </div>
                                    <div style="display: flex; align-items: center; gap: 0.5rem;">
                                        <input type="checkbox" id="french">
                                        <label for="french">French</label>
                                    </div>
                                </div>
                            </div>

                            <div class="form-group">
                                <label class="form-label">Specializations</label>
                                <div class="expertise-tags">
                                    <span class="expertise-tag">Wildlife Identification</span>
                                    <span class="expertise-tag">Bird Watching</span>
                                    <span class="expertise-tag">Photography Guide</span>
                                    <span class="expertise-tag">Leopard Tracking</span>
                                    <span class="expertise-tag">Elephant Behavior</span>
                                    <span class="expertise-tag">Night Safari</span>
                                </div>
                            </div>

                            <div class="form-group">
                                <label class="form-label">Bio</label>
                                <textarea class="form-control" id="guideBio" rows="4" placeholder="Tell us about your experience and passion for wildlife..."></textarea>
                            </div>
                        </div>

                        <button type="submit" class="btn btn-primary">
                            Update Profile
                        </button>
                    </form>
                </div>
            </section>

            <!-- Availability Section -->
            <section class="content-section" id="availability">
                <div class="section-header">
                    <h2 class="section-title">Manage Availability</h2>
                    <button class="btn btn-primary" onclick="bulkUpdateAvailability()">Bulk Update</button>
                </div>

                <div class="availability-calendar">
                    <div style="display: flex; justify-content: between; align-items: center; margin-bottom: 2rem;">
                        <h3 style="color: var(--primary-color);">Set Your Availability</h3>
                        <div>
                            <button class="btn btn-outline" onclick="previousMonth()">‚Üê Previous</button>
                            <span style="margin: 0 1rem; font-weight: 600;">January 2025</span>
                            <button class="btn btn-outline" onclick="nextMonth()">Next ‚Üí</button>
                        </div>
                    </div>

                    <div style="display: grid; grid-template-columns: repeat(7, 1fr); gap: 1rem; margin-bottom: 1rem; text-align: center; font-weight: 600;">
                        <div>Sun</div><div>Mon</div><div>Tue</div><div>Wed</div><div>Thu</div><div>Fri</div><div>Sat</div>
                    </div>
                    <div class="calendar-grid" id="availabilityCalendar">
                        <!-- Calendar days will be generated here -->
                    </div>

                    <div style="margin-top: 2rem;">
                        <h4 style="color: var(--primary-color); margin-bottom: 1rem;">Quick Actions</h4>
                        <div style="display: flex; gap: 1rem; flex-wrap: wrap;">
                            <button class="btn btn-outline" onclick="markWeekAvailable()">Mark This Week Available</button>
                            <button class="btn btn-outline" onclick="markWeekendUnavailable()">Mark Weekends Unavailable</button>
                            <button class="btn btn-outline" onclick="requestTimeOff()">Request Time Off</button>
                        </div>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <script src="../js/main.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Check authentication and guide role
            if (!SafariApp.Auth.isAuthenticated() || SafariApp.Auth.getUserRole() !== 'GUIDE') {
                window.location.href = '../login.html';
                return;
            }

            // Initialize guide dashboard
            initGuideDashboard();
            loadGuideData();
            loadAssignments();
            loadFeedback();
            generateCalendar();

            // Menu navigation
            document.querySelectorAll('.menu-item').forEach(item => {
                item.addEventListener('click', function(e) {
                    e.preventDefault();
                    const section = this.dataset.section;
                    showSection(section);

                    // Update active menu item
                    document.querySelectorAll('.menu-item').forEach(mi => mi.classList.remove('active'));
                    this.classList.add('active');
                });
            });
        });

        function initGuideDashboard() {
            // Load guide statistics
            loadGuideStats();
        }

        function loadGuideStats() {
            // Mock data for demonstration
            const stats = {
                todaysAssignments: 2,
                weeklyAssignments: 8,
                recentRating: 4.9,
                completionRate: 98
            };

            Object.keys(stats).forEach(key => {
                const element = document.getElementById(key);
                if (element) {
                    if (key === 'completionRate') {
                        element.textContent = `${stats[key]}%`;
                    } else {
                        element.textContent = stats[key];
                    }
                }
            });
        }

        function loadGuideData() {
            // Mock guide data
            const guideData = {
                firstName: 'Kumara',
                lastName: 'Perera',
                email: 'kumara@ranwelisafari.com',
                phone: '+94 77 123 4567',
                experience: 8,
                rating: 4.8,
                totalSafaris: 156,
                monthlyRating: 4.9
            };

            // Update profile form
            document.getElementById('profileFirstName').value = guideData.firstName;
            document.getElementById('profileLastName').value = guideData.lastName;
            document.getElementById('profileEmail').value = guideData.email;
            document.getElementById('profilePhone').value = guideData.phone;
            document.getElementById('experience').value = guideData.experience;

            document.getElementById('welcomeName').textContent = guideData.firstName;
        }

        function loadAssignments() {
            // Mock assignment data
            const assignments = [
                {
                    id: 'RNW-2025-001234',
                    customerName: 'John Smith',
                    package: 'Morning Safari',
                    date: '2025-01-15',
                    time: '06:00',
                    participants: 2,
                    driverName: 'Nimal Silva',
                    status: 'CONFIRMED',
                    specialRequests: 'Photography focused safari'
                },
                {
                    id: 'RNW-2025-001235',
                    customerName: 'Emma Johnson',
                    package: 'Evening Safari',
                    date: '2025-01-15',
                    time: '15:30',
                    participants: 4,
                    driverName: 'Kamal Dias',
                    status: 'CONFIRMED',
                    specialRequests: 'Family with young children'
                }
            ];

            displayAssignments(assignments, 'todaysAssignmentsList');
            displayAssignments(assignments, 'allAssignments');
        }

        function displayAssignments(assignments, containerId) {
            const container = document.getElementById(containerId);

            if (assignments.length === 0) {
                container.innerHTML = `
                    <div style="text-align: center; padding: 3rem; color: var(--text-light);">
                        <div style="font-size: 3rem; margin-bottom: 1rem;">üìÖ</div>
                        <h3>No assignments today</h3>
                        <p>Check your schedule for upcoming safaris.</p>
                    </div>
                `;
                return;
            }

            container.innerHTML = assignments.map(assignment => `
                <div class="assignment-card">
                    <div class="assignment-header">
                        <div>
                            <h4 style="color: var(--primary-color); margin-bottom: 0.5rem;">${assignment.package}</h4>
                            <p style="color: var(--text-light); font-size: 0.9rem;">Booking: ${assignment.id}</p>
                        </div>
                        <div class="status-badge status-${assignment.status.toLowerCase()}">${assignment.status}</div>
                    </div>

                    <div class="assignment-details">
                        <div class="detail-item">
                            <span class="detail-icon">üë•</span>
                            <span>Customer: ${assignment.customerName}</span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-icon">üìÖ</span>
                            <span>${SafariApp.formatDate(assignment.date)}</span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-icon">üïê</span>
                            <span>${assignment.time}</span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-icon">üë®‚Äçüë©‚Äçüëß‚Äçüë¶</span>
                            <span>${assignment.participants} participants</span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-icon">üöó</span>
                            <span>Driver: ${assignment.driverName}</span>
                        </div>
                    </div>

                    ${assignment.specialRequests ? `
                        <div style="background: #f8f9fa; padding: 1rem; border-radius: 8px; margin: 1rem 0;">
                            <strong>Special Requests:</strong> ${assignment.specialRequests}
                        </div>
                    ` : ''}

                    <div class="assignment-actions">
                        <button class="btn btn-primary btn-sm" onclick="viewAssignmentDetails('${assignment.id}')">View Details</button>
                        <button class="btn btn-outline btn-sm" onclick="contactCustomer('${assignment.id}')">Contact Customer</button>
                        <button class="btn btn-sm" style="background: var(--secondary-color); color: white;" onclick="startSafari('${assignment.id}')">Start Safari</button>
                    </div>
                </div>
            `).join('');
        }

        function loadFeedback() {
            // Mock feedback data for guide
            const feedbackData = [
                {
                    id: 1,
                    customerName: 'John Smith',
                    rating: 5,
                    date: '2025-01-12',
                    feedback: 'Kumara was absolutely fantastic! His knowledge of wildlife is incredible and he spotted animals we never would have seen. Highly recommend!',
                    highlights: 'Excellent wildlife knowledge, spotted leopard, very professional'
                },
                {
                    id: 2,
                    customerName: 'Emma Johnson',
                    rating: 5,
                    date: '2025-01-10',
                    feedback: 'Amazing guide! Very passionate about conservation and made the safari educational and fun. Great English communication.',
                    highlights: 'Conservation knowledge, great communication, educational'
                },
                {
                    id: 3,
                    customerName: 'Michael Chen',
                    rating: 4,
                    date: '2025-01-08',
                    feedback: 'Good guide with solid experience. Helped us get great photos. Could improve on bird identification but overall very satisfied.',
                    highlights: 'Photography assistance, good experience, helpful'
                }
            ];

            displayGuideFeedback(feedbackData);
        }

        function displayGuideFeedback(feedbackData) {
            const container = document.getElementById('guideFeedbackList');

            container.innerHTML = feedbackData.map(feedback => `
                <div class="feedback-item">
                    <div style="display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 1rem;">
                        <div>
                            <h4 style="color: var(--primary-color); margin-bottom: 0.5rem;">${feedback.customerName}</h4>
                            <p style="color: var(--text-light); font-size: 0.9rem;">${SafariApp.formatDate(feedback.date)}</p>
                        </div>
                        <div class="rating-display">
                            <div class="rating-stars">
                                ${generateStars(feedback.rating)}
                            </div>
                            <span style="font-weight: 600; color: var(--primary-color);">${feedback.rating}/5</span>
                        </div>
                    </div>

                    <p style="font-style: italic; margin: 1rem 0; color: var(--text-color);">"${feedback.feedback}"</p>

                    <div style="background: white; padding: 1rem; border-radius: 8px; margin-top: 1rem;">
                        <strong style="color: var(--primary-color);">Highlights:</strong> ${feedback.highlights}
                    </div>
                </div>
            `).join('');
        }

        function generateStars(rating) {
            let stars = '';
            for (let i = 1; i <= 5; i++) {
                stars += `<span class="rating-star">${i <= rating ? '‚òÖ' : '‚òÜ'}</span>`;
            }
            return stars;
        }

        function generateCalendar() {
            const calendar = document.getElementById('scheduleCalendar');
            const availabilityCalendar = document.getElementById('availabilityCalendar');

            // Generate calendar for current month (January 2025)
            const days = [];
            for (let i = 1; i <= 31; i++) {
                const dayStatus = Math.random() > 0.7 ? 'booked' : Math.random() > 0.5 ? 'available' : 'unavailable';
                days.push(`
                    <div class="calendar-day ${dayStatus}" onclick="toggleDayAvailability(this, ${i})">
                        ${i}
                        <div class="status-indicator ${dayStatus}"></div>
                    </div>
                `);
            }

            if (calendar) calendar.innerHTML = days.join('');
            if (availabilityCalendar) availabilityCalendar.innerHTML = days.join('');
        }

        function toggleDayAvailability(element, day) {
            const statuses = ['available', 'unavailable'];
            const currentStatus = element.classList.contains('available') ? 'available' :
                               element.classList.contains('booked') ? 'booked' : 'unavailable';

            if (currentStatus === 'booked') {
                SafariApp.Notifications.info('Cannot change availability for days with confirmed bookings');
                return;
            }

            const newStatus = currentStatus === 'available' ? 'unavailable' : 'available';

            element.className = `calendar-day ${newStatus}`;
            element.querySelector('.status-indicator').className = `status-indicator ${newStatus}`;

            SafariApp.Notifications.success(`Day ${day} marked as ${newStatus}`);
        }

        function showSection(sectionId) {
            document.querySelectorAll('.content-section').forEach(section => {
                section.classList.remove('active');
            });
            document.getElementById(sectionId).classList.add('active');
        }

        function toggleSidebar() {
            document.getElementById('sidebar').classList.toggle('active');
        }

        function logout() {
            SafariApp.Auth.logout();
        }

        // Mock functions for guide actions
        function viewAssignmentDetails(id) {
            SafariApp.Notifications.info(`Viewing assignment details for ${id} - Feature coming soon!`);
        }

        function contactCustomer(id) {
            SafariApp.Notifications.info(`Contacting customer for booking ${id} - Feature coming soon!`);
        }

        function startSafari(id) {
            SafariApp.Notifications.success(`Starting safari for booking ${id}!`);
        }

        function exportSchedule() {
            SafariApp.Notifications.info('Exporting schedule - Feature coming soon!');
        }

        function requestTimeOff() {
            SafariApp.Notifications.info('Time off request - Feature coming soon!');
        }

        function bulkUpdateAvailability() {
            SafariApp.Notifications.info('Bulk availability update - Feature coming soon!');
        }

        function markWeekAvailable() {
            SafariApp.Notifications.success('Week marked as available!');
        }

        function markWeekendUnavailable() {
            SafariApp.Notifications.success('Weekends marked as unavailable!');
        }

        function previousMonth() {
            SafariApp.Notifications.info('Previous month - Feature coming soon!');
        }

        function nextMonth() {
            SafariApp.Notifications.info('Next month - Feature coming soon!');
        }
    </script>
</body>
</html>

